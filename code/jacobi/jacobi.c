
#include<stdio.h>
#include<stdlib.h>
#include<stdint.h>
#include<math.h>

#define ROW 10
#define COL 10


int main()
{
	////////////////////////////////// A matrix //////////////////////////////////
	//will be given
    double A[ROW][COL] = {-4,  2,  0,  0,  0,  0,  0,  0,  0,  0,
					  2 , -4,  2,  0,  0,  0,  0,  0,  0,  0,
					  0 ,  2, -4,  2,  0,  0,  0,  0,  0,  0,
					  0 ,  0,  2, -4,  2,  0,  0,  0,  0,  0,
					  0 ,  0,  0,  2, -4,  2,  0,  0,  0,  0,
					  0 ,  0,  0,  0,  2, -4,  2,  0,  0,  0,
					  0 ,  0,  0,  0,  0,  2, -4,  2,  0,  0,
					  0 ,  0,  0,  0,  0,  0,  2, -4,  2,  0,
					  0 ,  0,  0,  0,  0,  0,  0,  2, -4,  2,
					  0 ,  0,  0,  0,  0,  0,  0,  0,  2, -4};
	////////////////////////////////// D matrix //////////////////////////////////
    double D[ROW][COL];
	for(int32_t i = 0; i < ROW; i++)
	{
	    for(int32_t j = 0; j < COL; j++)
	    {
			if(i == j)
			{
				D[i][j] = A[i][j];
			}
			else
			{
				D[i][j] = 0;
			}
	    }
	}
	////////////////////////////////// L matrix //////////////////////////////////
    double L[ROW][COL];
	for(int32_t i = 0; i < ROW; i++)
	{
	    for(int32_t j = 0; j < COL; j++)
	    {
			if(i < j)
			{
				L[i][j] = A[i][j];
			}
			else
			{
				L[i][j] = 0;
			}
	    }
	}
	////////////////////////////////// U matrix //////////////////////////////////
    double U[ROW][COL];
	for(int32_t i = 0; i < ROW; i++)
	{
	    for(int32_t j = 0; j < COL; j++)
	    {
			if(i > j)
			{
				U[i][j] = A[i][j];
			}
			else
			{
				U[i][j] = 0;
			}
	    }
	}
	//////////////////////////////// D^-1 matrix ////////////////////////////////
    double D_[ROW][COL];
	for(int32_t i = 0; i < ROW; i++)
	{
	    for(int32_t j = 0; j < COL; j++)
	    {
			if(i == j)
			{
				D_[i][j] = 1.0 / A[i][j];
			}
			else
			{
				D_[i][j] = 0;
			}
	    }
	}
	/////////////////////////////// Xk vector ///////////////////////////////
    double Xk[COL] = {2, 2, 2, 2, 2, 2, 2, 2, 2, 2};
	/////////////////////////////// b vector ///////////////////////////////
	// will be given
    double b[COL] = {2, 3, 4, 5, 6, 7, 8, 9, 10, 11};

	/////////////////////////////////////////////////////////////////////////////
	/////////////////////////////// Jacobi method ///////////////////////////////
	/////////////////////////////////////////////////////////////////////////////
	/////////// ===> Xk__ = D^-1 * ( b - (L+U) * Xk ) = D^-1 * Xk_ <=== /////////
	////////////////// Step 1. find L+U                       ///////////////////
	////////////////// Step 2. find (L+U)*Xk                  ///////////////////
	////////////////// Step 3. find b - (L+U)*Xk              ///////////////////
	////////////////// Step 4. find D^-1 * ( b - (L+U) * Xk ) ///////////////////
	/////////////////////////////////////////////////////////////////////////////

    //////////////////////////////// L + U ==> C ////////////////////////////////
    double C[ROW][COL] = {0};
    for(int32_t i = 0; i < ROW; i++)
    {
		for(int32_t j = 0; j < COL; j++)
		{
			C[i][j] = L[i][j] + U[i][j];
		}
    }

	///////////////////// Xk+1 = D^-1 * ( b - (L+U) * Xk ) /////////////////////
    int32_t flag = 1;
    while( flag )
    {
		////////////////////////// (L+U) * Xk ==> Xk_ //////////////////////////
		double Xk_[COL] = {0};
		for(int32_t i = 0; i < COL; i++)
		{
		for(int32_t j = 0; j < COL; j++)
		{
			Xk_[i] += C[i][j] * Xk[j];
		}
		}
		//////////////////////// b - (L+U) * Xk ==> Xk_ /////////////////////////
		for(int32_t i = 0; i < ROW; i++)
		{
			Xk_[i] = b[i] - Xk_[i];
		}
		
		//////////// D^-1 * ( b - (L+U) * Xk ) = D^-1 * Xk_ ==> Xk__ ////////////
		double Xk__[COL] = {0};
		for(int32_t i = 0; i < COL; i++)
		{
			for(int32_t j = 0; j < COL; j++)
			{
				Xk__[i] += D_[i][j] * Xk_[j];
			}
		}

		for(int32_t i = 0; i < COL; i++)
		{
			if( fabs( Xk__[i] - Xk[i] ) < 0.000001 )
			{
				flag *= 1;
			}
			else
			{
				flag *= 0;
				break;
			}
		}

		for(int32_t i = 0; i < COL; i++)
		{
			Xk[i] = Xk__[i];
		}

		if( flag == 1)
		{
			break;
		}
		else
		{
			flag = 1;
		}

    }

    //////////////////////// print result ////////////////////////
    printf("Answer: \n");
    for(int32_t i = 0; i < COL; i++)
    {
		printf("\tX%d = %lf", i+1, Xk[i]);
		if( i == 3)	printf("\n");
    }
    printf("\n");

   return 0;
}
